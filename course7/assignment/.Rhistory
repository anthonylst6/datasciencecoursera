fit3<- glm(count ~ factor(spray), family = 'poisson', data = InsectSprays)
summary(fit3)
exp(coef(fit3))
1/1.0574713
x <- -5:5
y <- c(5.12, 3.93, 2.67, 1.87, 0.52, 0.08, 0.93, 2.05, 2.54, 3.87, 4.97)
plot(x, y)
knots <- 0
splineTerms <- sapply(knots, function(knot) (x>knot) * (x - knot))
splineTerms
xMat <- cbind(1, x, splineTerms)
fit4 <- lm(y ~ xMat - 1)
summary(fit4)
yhat <- predict(fit4)
yhat
lines(x, yhat, col= 'red')
abline(h = 0)
abline(v = 0)
abline(h = -0.18258)
data(mtcars)
str(mtcars)
head(mtcars)
?mtcars
plot(am, mpg, data = mtcars)
plot(mtcars$am, mtcars$mpg,)
plot(mtcars$am, mtcars$mpg)
fit1 <- lm(mpg ~ am, data = mtcars)
summary(fit1)
par(mfrow = c(2, 2))
plot(fit1)
cor(mtcars)
fitall <- lm(mpg ~ ., data = mtcars)
summary(fitall)
?vif
library(cars)
library(car)
?vif
vif(fit1)
vif(fitall)
str(mtcars)
fit1 <- lm(mpg ~ factor(am), data = mtcars)
summary(fit1)
par(mfrow = c(2, 2))
plot(fit1)
?mtcars
fit2 <- lm(mpg ~ factor(am) + cyl, data = mtcars)
fit3 <- lm(mpg ~ factor(am) + cyl + disp, data = mtcars)
fit4 <- lm(mpg ~ factor(am) + cyl + disp + hp, data = mtcars)
fit5 <- lm(mpg ~ factor(am) + cyl + disp + hp + drat, data = mtcars)
fit6 <- lm(mpg ~ factor(am) + cyl + disp + hp + drat + wt, data = mtcars)
fit7 <- lm(mpg ~ factor(am) + cyl + disp + hp + drat + wt + qsec, data = mtcars)
fit8 <- lm(mpg ~ factor(am) + cyl + disp + hp + drat + wt + qsec + factor(vs), data = mtcars)
fit9 <- lm(mpg ~ factor(am) + cyl + disp + hp + drat + wt + qsec + factor(vs) + gear, data = mtcars)
fit10 <- lm(mpg ~ factor(am) + cyl + disp + hp + drat + wt + qsec + factor(vs) + gear + carb, data = mtcars)
anova(fit1, fit2, fit3, fit4, fit5, fit6, fit7, fit8, fit9, fit10)
fit <- lm(mpg ~ factor(am) + cyl + hp + wt, data = mtcars)
summary(fit)
plot(fit)
fit11 <- lm(mpg ~ factor(am) + cyl + hp + wt, data = mtcars)
vif(fit11)
fit12 <- lm(mpg ~ factor(am) + cyl + disp + hp + wt, data = mtcars)
summary(fit12)
plot(fit12)
vif(fit12)
anova(fit11, fit12)
cor(mtcars)
fit13 <- lm(mpg ~ factor(am) + cyl + wt, data = mtcars)
summary(fit13)
plot(fit13)
vif(fit13)
anova(fit13, fit11)
anova(fit13, fit12)
anova(fit13, fit10)
anova(fit10, fit13)
summary(fit11)
summary(fit12)
summary9fit13
summary(fit13)
anova(fit11, fit12, fit13)
vif(fit11)
vif(fit12)
vif(fit13)
fit13 <- lm(mpg ~ factor(am) + cyl + disp + wt, data = mtcars)
summary(fit13)
fit14 <- lm(mpg ~ factor(am) + cyl + wt, data = mtcars)
summary(fit14)
vif(fit13)
vif(fit12)
?anova
?Anova
anova(fit11, fit12, fit13, fit14)
anova(fit11, fit13)
fit1 <- lm(mpg ~ factor(am), data = mtcars)
fit2 <- lm(mpg ~ factor(am) + cyl, data = mtcars)
fit3 <- lm(mpg ~ factor(am) + cyl + disp, data = mtcars)
fit4 <- lm(mpg ~ factor(am) + cyl + disp + hp, data = mtcars)
fit5 <- lm(mpg ~ factor(am) + cyl + disp + hp + drat, data = mtcars)
fit6 <- lm(mpg ~ factor(am) + cyl + disp + hp + drat + wt, data = mtcars)
fit7 <- lm(mpg ~ factor(am) + cyl + disp + hp + drat + wt + qsec, data = mtcars)
fit8 <- lm(mpg ~ factor(am) + cyl + disp + hp + drat + wt + qsec + factor(vs), data = mtcars)
fit9 <- lm(mpg ~ factor(am) + cyl + disp + hp + drat + wt + qsec + factor(vs) + gear, data = mtcars)
fit10 <- lm(mpg ~ factor(am) + cyl + disp + hp + drat + wt + qsec + factor(vs) + gear + carb, data = mtcars)
anova(fit1, fit2, fit3, fit4, fit5, fit6, fit7, fit8, fit9, fit10)
cor(mtcars)
fit11 <- lm(mpg ~ factor(am) + cyl + wt, data = mtcars)
fit12 <- lm(mpg ~ factor(am) + cyl + hp + wt, data = mtcars)
fit13 <- lm(mpg ~ factor(am) + cyl + disp + wt, data = mtcars)
fit14 <- lm(mpg ~ factor(am) + cyl + disp + hp + wt, data = mtcars)
anova(fit11, fit12, fit13, dit14)
anova(fit11, fit12, fit13, fit14)
anova(fit11, fit12)
anova(fit11, fit14)
anova(fit11, fit12)
anova(fit11, fit13)
anova(fit11, fit14)
fit15 <- lm(mpg ~ factor(am) + disp + wt, data = mtcars)
summary(fit15)
vif(fit15)
anova(fit11, fit15)
anova(fit15, fit12)
anova(fit15, fit13)
anova(fit15, fit14)
fit11 <- lm(mpg ~ factor(am) + cyl + wt, data = mtcars)
fit12 <- lm(mpg ~ factor(am) + cyl + wt + hp, data = mtcars)
fit13 <- lm(mpg ~ factor(am) + cyl + wt + disp, data = mtcars)
fit14 <- lm(mpg ~ factor(am) + cyl + wt + hp + disp, data = mtcars)
vif(fit11)
vif(fit12)
vif(fit13)
vif(fit14)
anova(fit11, fit12)
anova(fit11, fit13)
anova(fit11, fit14)
anova(fit11, fit12, fit13, fit14)
fit11 <- lm(mpg ~ factor(am) + cyl + wt, data = mtcars)
fit12 <- lm(mpg ~ factor(am) + cyl + wt + disp, data = mtcars)
fit13 <- lm(mpg ~ factor(am) + cyl + wt + hp, data = mtcars)
fit14 <- lm(mpg ~ factor(am) + cyl + wt + disp + hp, data = mtcars)
anova(fit11, fit12)
anova(fit11, fit13)
anova(fit11, fit14)
anova(fit11, fit12, fit13, fit14)
vif(fit11)
vif(fit12)
vif(fit13)
vif(fit14)
anova(fit11, fit12)
anova(fit11, fit13)
anova(fit11, fit14)
summary(fit11)
summary(fit13)
plot(fit11)
plot(fit13)
plot(fit11)
plot(fit13)
plot(fit11)
confint(fit11)
confint(fit13)
# Try interaction term
fit15 <- lm(mpg ~ factor(am) + cyl * wt, data = mtcars)
summary(fit15)
anova(fit11, fit15)
fit16 <- lm(mpg ~ factor(am) + cyl * wt + disp * hp, data = mtcars)
summary(fit16)
anova(fit11, fit16)
fit16 <- lm(mpg ~ factor(am) + cyl * wt + disp, data = mtcars)
summary(fit16)
anova(fit11, fit16)
fit16 <- lm(mpg ~ factor(am) + cyl * wt + hp, data = mtcars)
summary(fit16)
anova(fit11, fit16)
anova(fit15, fit16)
fit17 <- lm(mpg ~ factor(am) + cyl + wt * hp, data = mtcars)
anova(fit11, fit17)
anova(fit15, fit16)
anova(fit15, fit17)
anova(fit16, fit17)
anova(fit15, fit16)
anova(fit15, fit17)
fit18 <- lm(mpg ~ factor(am) + cyl * hp + wt, data = mtcars)
anova(fit11, fit18)
anova(fit15, fit18)
anova(fit1, fit2, fit3, fit4, fit5, fit6, fit7, fit8, fit9, fit10)
fit19 <- lm(mpg ~ factor(am) + cyl * hp * wt, data = mtcars)
anova(fit11, fit19)
anova(fit15, fit19)
anova(fit15, fit18)
anova(fit15, fit17)
anova(fit15, fit16)
anova(fit11, fit15)
fit19 <- lm(log(mpg) ~ factor(am) + cyl * wt, data = mtcars)
anova(fit11, fit19)
summary(fit19)
summary(fit15)
summary(fit15)
anova(fit15, fit16)
anova(fit15, fit17)
anova(fit15, fit18)
# Try interaction term
fit15 <- lm(mpg ~ factor(am) + cyl * wt, data = mtcars)
fit16 <- lm(mpg ~ factor(am) + cyl * wt + hp, data = mtcars)
fit17 <- lm(mpg ~ factor(am) + cyl + wt * hp, data = mtcars)
fit18 <- lm(mpg ~ factor(am) + cyl * hp + wt, data = mtcars)
anova(fit15, fit16)
anova(fit15, fit17)
anova(fit15, fit17)
anova(fit15, fit16)
anova(fit15, fit17)
anova(fit15, fit18)
anova(fit11, fit15)
anova(fit11, fit15)
anova(fit11, fit16)
anova(fit11, fit17)
anova(fit11, fit18)
anova(fit15, fit16)
anova(fit15, fit17)
anova(fit15, fit18)
anova(fit11, fit17)
summary(fit17)
vif(fit15)
vif(fit16)
vif(fit17)
vif(fit18)
vif(fit11)
plot(fit17)
plot(fit11)
confint(fit17)
confint(fit11)
summary(fit11)
summary(fit17)
summary(fit15)
cor(mtcars)
mean(mtcars$mpg)
mean(mtcars$am)
fit17 <- lm(I(mpg - mean(mtcars$mpg)) ~ factor(I(am - mean(mtcars$am))) + I(cyl - mean(mtcars$cyl)) + I(wt - mean(mtcars$wt)) * I(hp - mean(mtcars$hp)), data = mtcars)
vif(fit17)
fit17 <- lm(mpg ~ factor(am) + cyl + wt * hp, data = mtcars)
fit19 <- lm(I(mpg - mean(mtcars$mpg)) ~ factor(I(am - mean(mtcars$am))) + I(cyl - mean(mtcars$cyl)) + I(wt - mean(mtcars$wt)) * I(hp - mean(mtcars$hp)), data = mtcars)
vif(fit19)
summary(fit19)
fit19 <- lm(I(mpg - mean(mtcars$mpg)) ~ factor(I(am - mean(mtcars$am))) + I(cyl - mean(mtcars$cyl)) + I(wt - mean(mtcars$wt)) * I(hp - mean(mtcars$hp) - 1), data = mtcars)
vif(fit19)
summary(fit19)
summary(fit17)
confint(fit17)
fit17 <- lm(mpg ~ factor(am) + cyl + wt * hp, data = mtcars)
anova(fit11, fit17)
summary(fit17)
plot(fit17)
str(mtcars)
5/32
par(mfrow = c(1, 1))
plot(mtcars$am, mtcars$mpg)
abline(fit17, col = 'red')
?hatvalues
par(mfrow = c(2, 2))
plot(fit17)
plot(hatvalues(fit17))
par(mfrow = c(1, 1))
plot(hatvalues(fit17))
?dfbeta
dfbeta(fit17)
plot(mtcars$am, mtcars$mpg)
?predict
str(mtcars)
head(mtcars['mpg'])
head(mtcars['am', 'cyl'])
head(mtcars[c('am', 'cyl')])
head(mtcars[c('am', 'cyl', 'wt', 'hp')])
predict(fit17, mtcars[c('am', 'cyl', 'wt', 'hp')])
plot(predict(fit17, mtcars[c('am', 'cyl', 'wt', 'hp')]), mtcars$mpg)
lines(10, 30, col = 'red')
?lines
lines(c(10, 10), c(30, 30), col = 'red')
lines(c(10, 10), c(30, 30), col = 'red')
lines(x = c(10, 10), y = c(30, 30), col = 'red')
plot(predict(fit17, mtcars[c('am', 'cyl', 'wt', 'hp')]), mtcars$mpg)
lines(x = c(10, 10), y = c(30, 30), col = 'red')
abline(x = c(10, 10), y = c(30, 30), col = 'red')
?abline
abline(a = 0, b = 1, col = 'red')
anova(fit1, fit2, fit3, fit4, fit5, fit6, fit7, fit8, fit9, fit10)
anova(fit1, fit2, fit3, fit4, fit5, fit6, fit7, fit8, fit9, fit10)
cor(mtcars)
?mtcars
fit19 <- lm(mpg ~ factor(am) + gear + cyl + wt * hp, data = mtcars)
summary(fit19)
fit19 <- lm(mpg ~ gear + cyl + wt * hp, data = mtcars)
summary(fit19)
# fit17 is an improvement from fit11
summary(fit17)
fit19 <- lm(mpg ~ factor(am) + cyl + gear * wt + hp, data = mtcars)
summary(fit19)
fit19 <- lm(mpg ~ factor(am) + cyl + gear * wt, data = mtcars)
summary(fit19)
fit19 <- lm(mpg ~ factor(am) + cyl + gear + wt, data = mtcars)
summary(fit19)
fit19 <- lm(mpg ~ factor(am) + gear + cyl * wt, data = mtcars)
summary(fit19)
fit19 <- lm(log(mpg) ~ factor(am) + cyl + wt * hp, data = mtcars)
summary(fit19)
anova(fit17, fit19)
# fit17 is an improvement from fit11
summary(fit17)
fit19 <- lm(mpg ~ factor(am) + cyl + sqrt(wt) * hp, data = mtcars)
summary(fit19)
# fit17 is an improvement from fit11
summary(fit17)
fit19 <- lm(mpg ~ factor(am) + cyl + sqrt(wt) * hp, data = mtcars)
summary(fit19)
fit19 <- lm(mpg ~ factor(am) + sqrt(cyl) + sqrt(wt) * hp, data = mtcars)
summary(fit19)
fit19 <- lm(mpg ~ factor(am) + sqrt(cyl) + sqrt(wt) * sqrt(hp), data = mtcars)
summary(fit19)
anova(fit17, fit19)
# fit17 is an improvement from fit11
summary(fit17)
plot(fit17)
par(mfrow = c(1, 1))
?predict
plot(predict(fit17, mtcars[c('am', 'cyl', 'wt', 'hp')]), mtcars$mpg)
abline(a = 0, b = 1, col = 'red')
vif(fit17)
data(mtcars)
str(mtcars)
head(mtcars)
?mtcars
library(car)
?vif
plot(mtcars$am, mtcars$mpg)
cor(mtcars)
fit1 <- lm(mpg ~ factor(am), data = mtcars)
fit2 <- lm(mpg ~ factor(am) + cyl, data = mtcars)
fit3 <- lm(mpg ~ factor(am) + cyl + disp, data = mtcars)
fit4 <- lm(mpg ~ factor(am) + cyl + disp + hp, data = mtcars)
fit5 <- lm(mpg ~ factor(am) + cyl + disp + hp + drat, data = mtcars)
fit6 <- lm(mpg ~ factor(am) + cyl + disp + hp + drat + wt, data = mtcars)
fit7 <- lm(mpg ~ factor(am) + cyl + disp + hp + drat + wt + qsec, data = mtcars)
fit8 <- lm(mpg ~ factor(am) + cyl + disp + hp + drat + wt + qsec + factor(vs), data = mtcars)
fit9 <- lm(mpg ~ factor(am) + cyl + disp + hp + drat + wt + qsec + factor(vs) + gear, data = mtcars)
fit10 <- lm(mpg ~ factor(am) + cyl + disp + hp + drat + wt + qsec + factor(vs) + gear + carb, data = mtcars)
anova(fit1, fit2, fit3, fit4, fit5, fit6, fit7, fit8, fit9, fit10)
fit11 <- lm(mpg ~ factor(am) + cyl + wt, data = mtcars)
fit12 <- lm(mpg ~ factor(am) + cyl + wt + disp, data = mtcars)
fit13 <- lm(mpg ~ factor(am) + cyl + wt + hp, data = mtcars)
fit14 <- lm(mpg ~ factor(am) + cyl + wt + disp + hp, data = mtcars)
anova(fit11, fit12)
anova(fit11, fit13)
anova(fit11, fit14)
vif(fit11)
vif(fit12)
vif(fit13)
vif(fit14)
summary(fit11)
plot(fit11)
par(mfrow = c(2, 2))
plot(fit11)
confint(fit11)
fit15 <- lm(mpg ~ factor(am) + cyl * wt, data = mtcars)
fit16 <- lm(mpg ~ factor(am) + cyl * wt + hp, data = mtcars)
fit17 <- lm(mpg ~ factor(am) + cyl + wt * hp, data = mtcars)
fit18 <- lm(mpg ~ factor(am) + cyl * hp + wt, data = mtcars)
anova(fit15, fit16)
anova(fit15, fit17)
anova(fit15, fit18)
vif(fit15)
vif(fit16)
vif(fit17)
vif(fit18)
anova(fit11, fit17)
# fit17 is an improvement from fit11
summary(fit17)
plot(fit17)
confint(fit17)
vif(fit17)
par(mfrow = c(1, 1))
?predict
plot(predict(fit17, mtcars[c('am', 'cyl', 'wt', 'hp')]), mtcars$mpg)
abline(a = 0, b = 1, col = 'red')
setwd("C:/Users/user/Desktop/datasciencecoursera/course7/assignment")
fit19 <- lm(sqrt(mpg) ~ factor(am) + cyl + wt * hp, data = mtcars)
summary(fit19)
# fit17 is an improvement from fit11
summary(fit17)
fit20 <- lm(log(mpg) ~ factor(am) + cyl + wt * hp, data = mtcars)
summary(fit19)
summary(fit20)
str(mtcars)
plot(mtcars$am, mtcars$mpg)
cor(mtcars)
anova(fit1, fit2, fit3, fit4, fit5, fit6, fit7, fit8, fit9, fit10)
anova(fit11, fit12)
anova(fit11, fit13)
anova(fit11, fit14)
vif(fit11)
vif(fit12)
vif(fit13)
vif(fit14)
anova(fit11, fit12, fit13, fit14)
vif(fit17)
summary(fit17)
anova(fit11, fit12, fit13, fit14)
anova(fit11, fit12)
anova(fit11, fit13)
anova(fit11, fit14)
x <- anova(fit1, fit2, fit3, fit4, fit5, fit6, fit7, fit8, fit9, fit10)
View(x)
x
x$Df
x$`Pr(>F)`
names(x)
type(x)
class(x)
x["data.frame"]
x$data.frame
data.frame(x)
x
print(x)
summary.aov(x)
summary.aov(fit1, fit2, fit3, fit4, fit5, fit6, fit7, fit8, fit9, fit10)
summary(x)
x
?plot
plot(mtcars$am, mtcars$mpg)
xlab('Fitted')
summary(fit17)$coef
coef(fit17)
confint(fit17)
confint(fit17)$factor(am)1
confint(fit17)[2]
confint(fit17)[2, ]
pairs(mtcars)
?pairs
plot(vif(fit17))
barplot(vif(fit17))
knitr::opts_chunk$set(echo = TRUE)
plot(predict(fit17, mtcars[c('am', 'cyl', 'wt', 'hp')]), mtcars$mpg)
plot(mtcars$am, mtcars$mpg)
plot(predict(fit17, mtcars[c('am', 'cyl', 'wt', 'hp')]), mtcars$mpg)
abline(a = 0, b = 1, col = 'red')
labels(x = 'test')
?labels
vif(fot17)
vif(fit17)
barplot(vif(fit17))
barplot(vif(fit17), xlab = 't')
barplot(vif(fit17), xlab = 'Variable', ylab = 'Variance inflation factor')
?text
str(mtcars)
barplot(vif(fit17), xlab = 'Variable', ylab = 'Variance inflation factor')
?text
text(0, 1, 'Test', col= 'red')
text(0, 1, 'Test', col = 'red', pos = 1)
text(1, 0, 'Test', col = 'red', pos = 1)
text(1, 1, 'Test', col = 'red', pos = 1)
barplot(vif(fit17), xlab = 'Variable', ylab = 'Variance inflation factor')
text(1, 1, 'Test', col = 'red', pos = 1)
text(0, 1, 'Test', col = 'red', pos = 1)
text(0, 1, 'Test', col = 'red')
text(5, 1, 'Test', col = 'red')
text(2, 1, 'Test', col = 'red')
text(3, 1, 'Test', col = 'red')
text(4, 1, 'Test', col = 'red')
text(4, 2, 'Test', col = 'red')
text(4, 4, 'Test', col = 'red')
text(6, 4, 'Test', col = 'red')
text(1, 4, 'Test', col = 'red')
text(2, 4, 'Test', col = 'red')
text(3, 4, 'Test', col = 'red')
text(4, 4, 'Test', col = 'red')
text(5, 4, 'Test', col = 'red')
barplot(vif(fit17), xlab = 'Variable', ylab = 'Variance inflation factor')
text(0.5, 4, 'Test', col = 'red')
text(0.7, 4, 'Test', col = 'red')
text(0.7, 2, 'Test', col = 'red')
text(2, 4, 'Test', col = 'red')
text(1.7, 4, 'Test', col = 'red')
text(1.9, 4, 'Test', col = 'red')
text(3, 4, 'Test', col = 'red')
text(3.2, 4, 'Test', col = 'red')
text(4, 4, 'Test', col = 'red')
text(4.4, 4, 'Test', col = 'red')
text(4.3, 4, 'Test', col = 'red')
text(5.5, 4, 'Test', col = 'red')
text(5.5, 4, vif(17)[5], col = 'red')
vif(17)
vif(fit17)
vif(fit17)[5]
text(5.5, 4, vif((fit17))[5], col = 'red')
text(5.5, 4, round(vif((fit17))[5], 2), col = 'red')
barplot(vif(fit17), xlab = 'Variable', ylab = 'Variance inflation factor')
text(5.5, 4, round(vif((fit17))[5], 2), col = 'red')
barplot(VIF, xlab = 'Variable', ylab = 'Variance inflation factor')
VIF <- vif(fit17)
barplot(VIF, xlab = 'Variable', ylab = 'Variance inflation factor')
for(i in 1:5) text(0.7 + 1.2 * (i - 1), 4, round(VIF[i], 2), col = 'red')
for(i in 1:5) text(0.7 + 1.2 * (i - 1), 3, round(VIF[i], 2), col = 'red')
for(i in 1:5) text(0.7 + 1.2 * (i - 1), 6, round(VIF[i], 2), col = 'red')
for(i in 1:5) text(0.7 + 1.2 * (i - 1), 5, round(VIF[i], 2), col = 'red')
coef(summary(fit17))
confint(fit17)
confint(fit17)[2]
confint(fit17)[2, ]
summary.lm(fit17)
summary(fit17)$coef
coef(fit17)
coefficients(fit17)
summary(fit17)$r.squared
plot(mtcars$am, mtcars$mpg, xlab = 'am', ylab = 'mpg', main = 'MPG and transmission')
abline(lm(mpg ~ factor(am), data = mtcars), col = 'red')
barplot(VIF, xlab = 'Variable', ylab = 'Variance inflation factor')
for(i in 1:5) text(0.7 + 1.2 * (i - 1), 3, round(VIF[i], 2), col = 'red')
